' Gambas class file

' Interfaz: tablero de juego para dibujar la serpiente, que tiene un botón para comenzar la
' partida, otro para pausar / continuar y unas etiquetas de texto que mostrarán los puntos conseguidos.
' La aplicación tendrá una ventana básica con botones de minimización, cerrar y ampliar.

'Atributos
Private DJ As Musica
Private serpentina As Serpiente
Private pasos As Integer

'Objeto vacío, hay que arreglarlo Monday November 28 2022
' Public Sub Form_Open()
' 
'    
'   yDJ.playSonidoMusica
' 
' End


Public Sub BComenzar_Click()

DJ = New Musica
DJ.playSonidoMusica()
serpentina = New Serpiente(200, 300, Color.Orange, "S")
Crono.Start()
LPuntos.Text = "0"
pasos = 0
DrawingArea1.SetFocus()

End



Public Sub BPausar_Click()

  If (Crono.Enabled) Then
      'estamos jugando, pausamos...
      BPausar.Text = "Continuar"
      Crono.Stop()   'pausamos el juego
  Else
      'si estoy pausado, continuamos...
      BPausar.Text = "Pausar"
      Crono.Start()
      DrawingArea1.SetFocus()  
  Endif

End


'Este comportamiento es para pintarse
Public Sub DrawingArea1_Draw()
 
  'Tengo que pedir a la serpiente que se dibuje... 
  If (serpentina <> Null) Then
    
    serpentina.pintarse(DrawingArea1)
    
  Endif
    
  
End


Public Sub Crono_Timer()



  pasos = pasos + 1
  
  If pasos = 3 Then 
      pasos = 0
      serpentina.crecer()
      DJ.playSonidoMini()
      
      Else
     serpentina.moverse()
     LPuntos.Text = LPuntos.Text + 1
     
     Endif
  
  'PROXIMAMENTE 11/28/2022 21:02:17
  If (serpentina.estasMuerta(DrawingArea1.Width, DrawingArea1.Height)) Then
     Crono.Stop() 
     Message.Info("Puntuación: " & LPuntos.Text & " pts")     
     LPuntos.Text = "0"
   
  
  Endif 

   DrawingArea1.Refresh()

End

'Qué hacer cuando pulsan teclas
Public Sub DrawingArea1_KeyPress()

  Dim miTecla As String

  miTecla = UCase$(Key.Text)
  
  If (miTecla = "W" Or miTecla = "A" Or miTecla = "S" Or miTecla = "D") Then
     serpentina.cambiaDir(miTecla)
  Endif  

End


