' Gambas class file

Private viborita As Snake

Private miManzana As Square
Private superManzana As Boolean
Private contador As Short



Public Sub Jugar_Click()

  viborita = New Snake(200, 300, 234543, "W")
  miManzana = New Square(Color.RGB(255, 0, 0), 20, Rand(0, DrawingArea1.height), Rand(0, DrawingArea1.width))
  contador = 0
  Crono.Start()

 

End

Public Sub checkapple()
  
  If viborita.seComeManzana(miManzana) = True Then
    
    miManzana.setPosX(Rand(0, DrawingArea1.height - 60))
    miManzana.setPosY(Rand(0, DrawingArea1.width - 60)) 
    DrawingArea1.Refresh()
    contador = 1
    superManzana = True
    viborita.crecer()
    LPuntos.Text = LPuntos.Text + 10
      Else 
        viborita.moverse()
  Endif
  If contador >= 1 And contador <= 20 Then
    viborita.setSuperPoder(superManzana)
    contador = contador + 1
    Else 
      contador = 0
      superManzana = False
      viborita.setSuperPoder(superManzana)
  Endif
     
End


Public Sub Crono_Timer()
  checkapple()
  If (viborita.estasMuerta(DrawingArea1)) Then
     crono.Stop() 
     Message.Info("Score: " & LPuntos.Text & " points")     
     LPuntos.Text = "0"
   Else
     DrawingArea1.Refresh()

  Endif 

End

Public Sub DrawingArea1_Draw()

  If (miManzana <> Null) Then 
       miManzana.pintarse(DrawingArea1)
   Endif
  If (viborita <> Null) Then 
     viborita.pintarse(DrawingArea1)
  Endif

End

Public Sub Form_KeyPress()
  Dim miTecla As String

  miTecla = UCase$(Key.Text)
  If (miTecla = "W" Or miTecla = "A" Or miTecla = "S" Or miTecla = "D") Then
     viborita.cambiaDir(miTecla)
  Endif  

End
Public Sub DrawingArea1_KeyPress()
  
  Form_KeyPress()
  
End
